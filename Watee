<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="HydroTrack">
    
    <link rel="apple-touch-icon" href="IMG_3634.png">
    
    <title>HydroTrack</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .man-mask {
            mask-image: url('https://upload.wikimedia.org/wikipedia/commons/e/e5/Human-shadow.svg');
            mask-size: contain; mask-repeat: no-repeat; mask-position: center;
            -webkit-mask-image: url('https://upload.wikimedia.org/wikipedia/commons/e/e5/Human-shadow.svg');
            -webkit-mask-size: contain; -webkit-mask-repeat: no-repeat; -webkit-mask-position: center;
        }
        select { -webkit-appearance: none; }
    </style>
</head>
<body class="bg-slate-50 flex flex-col items-center h-screen p-6 font-sans overflow-hidden">

    <div id="clock" class="text-slate-400 font-mono text-sm mb-2">00:00:00</div>

    <button onclick="setGoal()" class="bg-white shadow-sm border px-6 py-2 rounded-full font-bold text-blue-600">
        Cel: <span id="display-goal">2500</span> ml
    </button>

    <div class="flex-grow flex flex-col justify-center items-center w-full">
        <div class="relative w-48 h-80">
            <div class="absolute inset-0 bg-gray-200 man-mask"></div>
            <div id="water-fill" class="absolute inset-0 bg-blue-500 man-mask transition-all duration-700" style="height: 0%; top: auto;"></div>
        </div>
        <div class="mt-4 text-center">
            <div class="text-4xl font-black text-slate-800"><span id="total">0</span></div>
            <div class="text-slate-400 uppercase tracking-widest text-[10px]">ml nawodnienia</div>
        </div>
    </div>

    <div class="flex items-center justify-center gap-8 w-full mb-12">
        <button onclick="changeAmount()" class="w-16 h-16 bg-white shadow-lg rounded-full border-2 border-blue-50 flex flex-col items-center justify-center active:scale-95 transition">
            <span id="btn-amount" class="font-bold text-blue-600">250</span>
            <span class="text-[10px] text-gray-400">ml</span>
        </button>

        <button onclick="addDrink()" class="w-24 h-24 bg-blue-600 shadow-2xl rounded-full flex items-center justify-center text-white text-4xl active:scale-90 transition border-4 border-white">
            +
        </button>

        <div class="relative w-16 h-16">
            <select id="beverage" class="w-full h-full bg-white shadow-lg rounded-full border-2 border-blue-50 text-center text-2xl outline-none cursor-pointer">
                <option value="1.0">üíß Woda</option>
                <option value="1.2">ü•• W. Koko</option>
                <option value="0.95">üçµ Herbata</option>
                <option value="0.8">‚òï Kawa</option>
                <option value="1.1">ü•õ Mleko</option>
                <option value="0.5">‚ö° Energy</option>
                <option value="0.92">üçâ Arbuz</option>
                <option value="0.91">üçì Truskawka</option>
                <option value="0.85">üçä Mandarynka</option>
                <option value="0.75">üçå Banan</option>
            </select>
        </div>
    </div>

    <script>
        let total = parseFloat(localStorage.getItem('total')) || 0;
        let goal = parseInt(localStorage.getItem('goal')) || 2500;
        let lastDate = localStorage.getItem('lastDate') || new Date().toLocaleDateString();
        const amounts = [100, 200, 250, 330, 500, 1000];
        let amtIdx = 2;

        function checkNewDay() {
            const today = new Date().toLocaleDateString();
            if (today !== lastDate) {
                total = 0;
                lastDate = today;
                localStorage.setItem('total', 0);
                localStorage.setItem('lastDate', today);
                update();
            }
        }

        function updateClock() {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
            checkNewDay();
        }

        function setGoal() {
            let n = prompt("Tw√≥j cel (ml):", goal);
            if(n) { goal = parseInt(n); localStorage.setItem('goal', goal); update(); }
        }

        function changeAmount() {
            amtIdx = (amtIdx + 1) % amounts.length;
            document.getElementById('btn-amount').innerText = amounts[amtIdx];
        }

        function addDrink() {
            checkNewDay();
            const f = parseFloat(document.getElementById('beverage').value);
            total += amounts[amtIdx] * f;
            localStorage.setItem('total', total);
            update();
        }

        function update() {
            document.getElementById('total').innerText = Math.round(total);
            document.getElementById('display-goal').innerText = goal;
            const p = Math.min((total / goal) * 100, 100);
            document.getElementById('water-fill').style.height = p + "%";
        }

        setInterval(updateClock, 1000);
        update();
    </script>
</body>
</html>
